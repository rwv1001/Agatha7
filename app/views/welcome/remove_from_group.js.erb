<% if db_group== nil %>
    if (window.showNotification) {
      window.showNotification('<%="Remove Selected Failed: Could not find group id #{group_id} in database"%>', 'error');
    } else {
      alert('<%="Remove Selected Failed: Could not find group id #{group_id} in database"%>');
    }
<% elsif(!permission) %>
    if (window.showNotification) {
      window.showNotification('<%="Remove Selected Failed: You do not have permission to edit group #{db_group.group_name}"%>', 'error');
    } else {
      alert('<%="Remove Selected Failed: You do not have permission to edit group #{db_group.group_name}"%>');
    }
<% elsif(!class_ok) %>
    if (window.showNotification) {
      window.showNotification('<%="Remove Selected Failed: The #{db_group.group_name} is for members of type #{db_group.table.classify} rather than type #{class_name2}"%>', 'error');
    } else {
      alert('<%="Remove Selected Failed: The #{db_group.group_name} is for members of type #{db_group.table.classify} rather than type #{class_name2}"%>');
    }
<% elsif(ids.length == 0) %>
    if (window.showNotification) {
      window.showNotification('<%="Remove Selected Failed: You have not selected any #{db_group.table_name}"%>', 'error');
    } else {
      alert('<%="Remove Selected Failed: You have not selected any #{db_group.table_name}"%>');
    }
<% else %>
    <% success_str = ""  %>
    <% if  num_existing == 1 %>
        <% success_str << "1 #{class_name2} has been removed from the group #{db_group.group_name}. " %>
    <% elsif num_existing >1 %>
        <% success_str << "#{num_existing} #{class_name2.tableize} have been removed from the group #{db_group.group_name}. " %>
    <% end %>
    <% if not_present_members.length == 1 %>
        <% success_str <<  "1 #{class_name2} was not in the group #{db_group.group_name} to begin with. " %>
    <% elsif not_present_members.length > 1  %>
        <% success_str << "#{not_present_members.length} #{class_name2.tableize} were not in the group #{db_group.group_name} to begin with." %>
    <% end %>

    // ActionCable will handle table updates automatically
    action_select_no_js();    
    if (window.showNotification) {
      window.showNotification('<%="#{success_str}"%>', 'success');
    } else {
      alert('<%="#{success_str}"%>');
    }
<% end %>
unwait();
